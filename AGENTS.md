# Repository Guidelines

This document guides contributors and coding agents working on the Coffee Shop Astrophysics website (Hugo + Tailwind).

## Project Overview
- **Site**: Coffee Shop Astrophysics (Hugo static site)
- **Theme**: Custom theme at `themes/csa`
- **Live URL**: https://coffeeshopastrophysics.github.io/
- **Base URL**: `baseURL = "https://coffeeshopastrophysics.github.io/"` in `hugo.toml`

## Project Structure & Module Organization
- `content/`: Markdown pages and sections (use kebab-case filenames).
- `themes/csa/`: Theme templates, CSS, and JS (primary UI work lives here).
- `layouts/`: Site-level overrides to theme templates/partials.
- `assets/` and `themes/csa/assets/`: Tailwind/PostCSS sources (CSS entrypoint at `themes/csa/assets/css/main.css`).
- `static/`: Static files served verbatim (images, favicon, etc.).
- `data/`, `archetypes/`, `i18n/`: Hugo data, content starters, translations.
- `hugo.toml`: Site configuration (menus, theme, URL behavior); main menu configured under `[menus]`.
- `Makefile`, `package.json`, `tailwind.config.js`, `postcss.config.js`: Dev tooling.
- `public/`: Build output (generated by Hugo) â€” do not edit by hand.

## Development & Build
- `make run-local`: Start local server with drafts and fast reload.
- `npm run run-local`: Equivalent local preview (`hugo server -D`).
- `npm ci` or `npm install`: Install Node dev dependencies for Tailwind/PostCSS.
- `hugo --gc --minify`: Production build to `public/` (matches CI workflow).
- CSS pipeline: PostCSS with Tailwind v4 via `@tailwindcss/postcss` in `postcss.config.js` and `@tailwindcss/typography` plugin.

## Architecture
- **Content**: Markdown files in `content/` rendered with layouts under `themes/csa/layouts/`.
- **Data-driven Talks**: `data/talks.yaml` drives the talks page at `themes/csa/layouts/talks/list.html` with Upcoming and Past sections and year separators.
- **Theme Layouts (highlights)**:
  - `_default/baseof.html`: Base template.
  - `_partials/head.html`, `head/css.html`, `head/js.html`: Asset pipeline with minify + fingerprinting in production.
  - `_partials/header.html`, `_partials/menu.html`, `_partials/footer.html`: Navigation and footer; footer includes an Archive link.
  - `home.html`, `page.html`, `contact.html`, `members/single.html`, `talks/list.html`.
- **Styling**: `themes/csa/assets/css/main.css` imports Tailwind and typography, sets CSS vars for teal, and forces `.prose a` colors to ensure correct production styling.
- **Tailwind config**: `tailwind.config.js` scans layouts and content; safelists prose link classes; `darkMode: 'class'`.

## Key Features
- Modern Tailwind-based design with dark mode support.
- Talks timeline: upcoming vs. past, date de-duplication on identical datetimes for grouped events.
- Footer includes link to archive at `https://coffeeshopastrophysics.github.io/website-archive/`.
- Asset pipeline: CSS via PostCSS; JS via Hugo `js.Build` with minify + fingerprint in production.
- SEO/meta handled in partials with proper page titles.

## Talks Data Format (`data/talks.yaml`)
Use RFC3339 datetimes and optional fields shown below:

```yaml
- title: "Talk Title"
  date: 2025-05-02T15:30:00-05:00
  speakers: ["Name (Affiliation)"]
  venue: "Room Location"
  venue_link: "https://maps.example"
  slides: "https://link-to-slides.pdf"
  video: "https://youtu.be/video-id"
  abstract: "Talk description"
```

Notes:
- Upcoming vs. Past determined by comparing `date` to `now`.
- Group multiple entries into a single date heading by using the exact same datetime.

## Coding Style & Naming Conventions
- Content: folders and files in `content/` use kebab-case; front matter in TOML/YAML.
- Templates: Go templates; place reusable pieces in `layouts/partials/`.
- CSS: Prefer Tailwind utilities; extend in `themes/csa/assets/css/main.css`.
- JS: Keep minimal; place in `themes/csa/assets/js/`.
- Indentation: 2 spaces for HTML/templating, JSON, JS, and CSS.
- Dark mode: Use class-based dark mode as configured in Tailwind.

## Testing & QA
- Run `make run-local` and ensure no Hugo build errors.
- Manually verify key pages: Home, Talks, Members, Posts, Contact.
- Check navigation active/hover states and the Archive link in the footer.
- Confirm dark mode, responsive layout, and prose link colors (teal) render correctly.
- Optional: run a Lighthouse audit locally for regressions.

## CI/CD
- GitHub Pages deploy via `.github/workflows/hugo.yaml`.
- Environment versions (as of workflow): Hugo `0.149.0`, Node.js `22.18.0`, Go `1.25.0`.
- Build uses `hugo --gc --minify` with fingerprinted assets and uploads `public/` as the artifact.

## Contribution Tips
- Update `hugo.toml` menus when adding pages; keep `baseURL` aligned with the Pages site.
- Do not commit secrets; configuration belongs in `hugo.toml` and content front matter.
- Do not edit files in `public/` directly.
- When editing talk data, validate YAML and dates; preview locally to verify Upcoming/Past categorization.

## Known Issues & Fixes
- Prose link colors could be lost in production tree-shaking; this is mitigated by:
  - Explicit `.prose a` styles in `themes/csa/assets/css/main.css` using CSS vars and `!important`.
  - Safelisted prose classes in `tailwind.config.js`.
- If link styles regress, check both files above and ensure the CSS pipeline runs (PostCSS configured in `postcss.config.js`).
